import { createSignal, For, onMount, Show } from 'solid-js';
import { NotificationModel, NotificationType } from '../../models/notification';
import { LocalStorageKey, SecureLocalStorage } from '../../lib/localstore';
import { UserModel } from '../../models/auth';
import { useAppContext } from '../../state';
import { NotificationApiHandler } from '../../api/backend/notification';

function getNotificationIcon(type: NotificationType): string {
    switch (type) {
        case 'message':
            return `<svg class="w-6 h-6 text-blue-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H2a2 2 0 01-2-2V5a2 2 0 012-2h16a2 2 0 012 2zM12 7H8v2h4V7zm0 3H8v2h4v-2z" clip-rule="evenodd"></path></svg>`;
        case 'job':
            return `<svg class="w-6 h-6 text-green-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path><path fill-rule="evenodd" d="M4 5a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h6a1 1 0 100-2H7zm0 4a1 1 0 100 2h3a1 1 0 100-2H7z" clip-rule="evenodd"></path></svg>`;
        case 'review':
            return `<svg class="w-6 h-6 text-yellow-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1.517l.939.782a1 1 0 001.328.058l1.65-.964a1 1 0 01.996.368l1.416 2.502a1 1 0 01-.292 1.344l-1.56.974a1 1 0 00-.472 1.258l.267 1.767c.05.328-.044.664-.265.918l-1.745 1.564a1 1 0 00-.332 1.488l.857 1.543a1 1 0 01-.107 1.157l-1.417 1.417a1 1 0 01-1.157.107l-1.543-.857a1 1 0 00-1.488.332l-1.564 1.745a1 1 0 01-.918.267l-1.767-.267a1 1 0 01-1.258.472l-.964-1.65a1 1 0 01.368-.996l2.502-1.416a1 1 0 011.344.292l1.56.974a1 1 0 001.258-.472l1.767-.267a1 1 0 01.918-.265l1.564 1.745a1 1 0 00.332 1.488l-.857 1.543a1 1 0 01-.107 1.157l1.417 1.417z" clip-rule="evenodd"></path></svg>`;
        case 'payment':
            return `<svg class="w-6 h-6 text-purple-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 002-2V4H4zm10 2a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h10z" clip-rule="evenodd"></path></svg>`;
        case 'system':
            return `<svg class="w-6 h-6 text-gray-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg>`;
        case 'contact':
            return `<svg class="w-6 h-6 text-indigo-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg>`;
        case 'appointment':
            return `<svg class="w-6 h-6 text-pink-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path></svg>`;
        case 'email':
            return `<svg class="w-6 h-6 text-orange-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg>`;
        case 'goal':
            return `<svg class="w-6 h-6 text-teal-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>`;
        case 'general':
        default:
            return `<svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l3 3a1 1 0 001.414-1.414L11 9.586V6z" clip-rule="evenodd"></path></svg>`;
    }
}

function formatRelativeTime(date: Date): string {
    const now = new Date();
    const diffMs = now.getTime() - date.getTime();
    const diffSeconds = Math.round(diffMs / 1000);
    const diffMinutes = Math.round(diffMs / (1000 * 60));
    const diffHours = Math.round(diffMs / (1000 * 60 * 60));
    const diffDays = Math.round(diffMs / (1000 * 60 * 60 * 24));

    if (diffSeconds < 60) return 'just now';
    if (diffMinutes < 60)
        return `${diffMinutes} min${diffMinutes !== 1 ? 's' : ''} ago`;
    if (diffHours < 24)
        return `${diffHours} hr${diffHours !== 1 ? 's' : ''} ago`;
    if (diffDays < 7) return `${diffDays} day${diffDays !== 1 ? 's' : ''} ago`;
    if (diffDays < 30)
        return `${Math.round(diffDays / 7)} week${
            Math.round(diffDays / 7) !== 1 ? 's' : ''
        } ago`;
    return date.toLocaleDateString('en-US', {
        month: 'short',
        day: 'numeric',
        year: 'numeric',
    });
}

const EmptyNotifications = () => {
    return (
        <div style="align-self: stretch; min-width: 100%; min-height: 100%; padding-left: 24px; padding-right: 24px; padding-top: 20px; padding-bottom: 20px; border-radius: 20px; outline-offset: -0.50px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
            <svg
                width="288"
                height="288"
                viewBox="0 0 288 288"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M213.259 90.812c17.752 20.828 10.016 51.189-5.115 71.47-22.816 30.58-78.803 46.955-115.097 22.435-27.521-18.599-46.333-52.093-36.645-81.584 7.638-23.219 31.18-48.022 60.117-54.484 22.7-5.07 23.806 9.216 34.324 19.36 4.326 4.17 11.676 4.244 17.747 4.676 9.515.68 18.783 1.463 27.308 5.392 7.396 3.398 13.11 7.747 17.361 12.735"
                    fill="#1376A1"
                />
                <path
                    opacity=".7"
                    d="M213.259 90.812c17.752 20.828 10.016 51.189-5.115 71.47-22.816 30.58-78.803 46.955-115.097 22.435-27.521-18.599-46.333-52.093-36.645-81.584 7.638-23.219 31.18-48.022 60.117-54.484 22.7-5.07 23.806 9.216 34.324 19.36 4.326 4.17 11.676 4.244 17.747 4.676 9.515.68 18.783 1.463 27.308 5.392 7.396 3.398 13.11 7.747 17.361 12.735"
                    fill="#fff"
                />
                <path
                    d="M46.12 217.296h16.74c-.317-2.045-1.636-1.687-1.809-4.861-.086-1.596 1.388-3.571 1.262-5.674-.104-1.728-1.81-3.502-1.942-5.478-.12-1.785 1.337-3.767 1.193-5.69-.133-1.815-1.86-3.56-2.01-5.449-.15-1.89 1.273-3.848 1.105-5.709s-1.93-3.582-2.114-5.42c-.184-1.837 1.187-3.922.974-5.76-.219-1.918-2.033-3.577-2.304-5.345-.276-1.964 1.008-4.072.708-5.76-.368-2.079-2.304-3.589-2.712-5.126-.76-2.88-.669-5.622-1.567-5.801-.899-.178-1.152 2.517-1.901 5.536-.363 1.52-2.258 3.058-2.575 5.143-.207 1.682 1.118 3.756.899 5.714-.196 1.728-1.959 3.456-2.131 5.351-.162 1.797 1.273 3.773 1.152 5.651s-1.85 3.565-1.97 5.42c-.121 1.855 1.359 3.796 1.261 5.622s-1.785 3.646-1.872 5.454c-.092 1.907 1.417 3.831 1.342 5.605-.08 1.958-1.728 3.755-1.803 5.472-.075 2.079 1.458 4.003 1.411 5.587-.103 3.456-1.681 2.73-1.728 5.495z"
                    fill="#1376A1"
                />
                <path
                    opacity=".2"
                    d="M46.12 217.296h16.74c-.317-2.045-1.636-1.687-1.809-4.861-.086-1.596 1.388-3.571 1.262-5.674-.104-1.728-1.81-3.502-1.942-5.478-.12-1.785 1.337-3.767 1.193-5.69-.133-1.815-1.86-3.56-2.01-5.449-.15-1.89 1.273-3.848 1.105-5.709s-1.93-3.582-2.114-5.42c-.184-1.837 1.187-3.922.974-5.76-.219-1.918-2.033-3.577-2.304-5.345-.276-1.964 1.008-4.072.708-5.76-.368-2.079-2.304-3.589-2.712-5.126-.76-2.88-.669-5.622-1.567-5.801-.899-.178-1.152 2.517-1.901 5.536-.363 1.52-2.258 3.058-2.575 5.143-.207 1.682 1.118 3.756.899 5.714-.196 1.728-1.959 3.456-2.131 5.351-.162 1.797 1.273 3.773 1.152 5.651s-1.85 3.565-1.97 5.42c-.121 1.855 1.359 3.796 1.261 5.622s-1.785 3.646-1.872 5.454c-.092 1.907 1.417 3.831 1.342 5.605-.08 1.958-1.728 3.755-1.803 5.472-.075 2.079 1.458 4.003 1.411 5.587-.103 3.456-1.681 2.73-1.728 5.495z"
                    fill="#fff"
                />
                <path
                    d="M53.309 156.741v59.783m2.615-53.516-2.724 2.356-2.235-2.972m4.959 11.025-2.724 2.35-2.235-2.973m4.959 10.409-2.724 2.35-2.235-2.972m4.959 12.263L53.2 197.2l-2.235-2.972m4.959 12.383-2.724 2.356-2.235-2.972"
                    stroke="#1E1E1E"
                    stroke-width=".607"
                    stroke-miterlimit="10"
                />
                <path
                    d="M34.721 217.296h12.92c-.248-1.578-1.261-1.301-1.4-3.749-.063-1.233 1.078-2.76.98-4.384-.087-1.33-1.4-2.701-1.504-4.228-.092-1.376 1.031-2.88.922-4.389-.11-1.509-1.434-2.753-1.555-4.21-.121-1.458.985-2.967.858-4.407s-1.486-2.765-1.63-4.182c-.144-1.416.916-3.029.749-4.423s-1.567-2.759-1.728-4.124c-.213-1.521.777-3.145.547-4.459-.282-1.607-1.78-2.77-2.097-3.957-.576-2.206-.513-4.337-1.204-4.475-.69-.138-.91 1.941-1.468 4.274-.283 1.152-1.728 2.361-1.988 3.968-.195 1.302.841 2.88.669 4.401-.15 1.354-1.51 2.655-1.642 4.13-.127 1.388.98 2.914.87 4.366s-1.429 2.747-1.521 4.182c-.092 1.434 1.048 2.926.973 4.337-.074 1.411-1.376 2.817-1.445 4.211-.07 1.393 1.094 2.96 1.036 4.325-.063 1.515-1.342 2.88-1.388 4.228-.057 1.607 1.152 3.088 1.083 4.309-.08 2.655-1.296 2.108-1.336 4.245z"
                    fill="#1376A1"
                />
                <path
                    opacity=".2"
                    d="M34.721 217.296h12.92c-.248-1.578-1.261-1.301-1.4-3.749-.063-1.233 1.078-2.76.98-4.384-.087-1.33-1.4-2.701-1.504-4.228-.092-1.376 1.031-2.88.922-4.389-.11-1.509-1.434-2.753-1.555-4.21-.121-1.458.985-2.967.858-4.407s-1.486-2.765-1.63-4.182c-.144-1.416.916-3.029.749-4.423s-1.567-2.759-1.728-4.124c-.213-1.521.777-3.145.547-4.459-.282-1.607-1.78-2.77-2.097-3.957-.576-2.206-.513-4.337-1.204-4.475-.69-.138-.91 1.941-1.468 4.274-.283 1.152-1.728 2.361-1.988 3.968-.195 1.302.841 2.88.669 4.401-.15 1.354-1.51 2.655-1.642 4.13-.127 1.388.98 2.914.87 4.366s-1.429 2.747-1.521 4.182c-.092 1.434 1.048 2.926.973 4.337-.074 1.411-1.376 2.817-1.445 4.211-.07 1.393 1.094 2.96 1.036 4.325-.063 1.515-1.342 2.88-1.388 4.228-.057 1.607 1.152 3.088 1.083 4.309-.08 2.655-1.296 2.108-1.336 4.245z"
                    fill="#fff"
                />
                <path
                    d="M40.269 170.554v46.149m2.016-41.311-2.103 1.815-1.722-2.293m3.825 8.508-2.103 1.82-1.722-2.293m3.825 8.03-2.103 1.814-1.722-2.293m3.825 9.464-2.103 1.821-1.722-2.299m3.825 9.568-2.103 1.814-1.722-2.292"
                    stroke="#1E1E1E"
                    stroke-width=".607"
                    stroke-miterlimit="10"
                />
                <path
                    d="M235.498 217.296h16.214c-.311-1.981-1.584-1.636-1.756-4.706-.081-1.549 1.347-3.456 1.226-5.495-.103-1.676-1.756-3.392-1.883-5.31-.115-1.728 1.296-3.646 1.152-5.507-.127-1.763-1.803-3.456-1.953-5.282s1.239-3.727 1.077-5.529c-.161-1.803-1.866-3.456-2.05-5.248-.185-1.791 1.152-3.801.944-5.552-.213-1.855-1.969-3.456-2.206-5.184-.265-1.907.98-3.94.686-5.588-.357-2.016-2.235-3.456-2.627-4.965-.737-2.77-.645-5.443-1.515-5.622-.869-.178-1.152 2.437-1.843 5.363-.351 1.475-2.189 2.961-2.488 4.982-.248 1.636 1.054 3.623.841 5.518-.19 1.728-1.901 3.341-2.068 5.184-.156 1.728 1.233 3.652 1.094 5.472-.138 1.821-1.791 3.456-1.906 5.248-.115 1.791 1.313 3.675 1.215 5.449s-1.728 3.531-1.808 5.282c-.087 1.843 1.37 3.709 1.296 5.426-.075 1.9-1.682 3.64-1.728 5.299-.075 2.022 1.405 3.882 1.359 5.414-.098 3.335-1.624 2.644-1.676 5.322z"
                    fill="#1376A1"
                />
                <path
                    opacity=".2"
                    d="M235.498 217.296h16.214c-.311-1.981-1.584-1.636-1.756-4.706-.081-1.549 1.347-3.456 1.226-5.495-.103-1.676-1.756-3.392-1.883-5.31-.115-1.728 1.296-3.646 1.152-5.507-.127-1.763-1.803-3.456-1.953-5.282s1.239-3.727 1.077-5.529c-.161-1.803-1.866-3.456-2.05-5.248-.185-1.791 1.152-3.801.944-5.552-.213-1.855-1.969-3.456-2.206-5.184-.265-1.907.98-3.94.686-5.588-.357-2.016-2.235-3.456-2.627-4.965-.737-2.77-.645-5.443-1.515-5.622-.869-.178-1.152 2.437-1.843 5.363-.351 1.475-2.189 2.961-2.488 4.982-.248 1.636 1.054 3.623.841 5.518-.19 1.728-1.901 3.341-2.068 5.184-.156 1.728 1.233 3.652 1.094 5.472-.138 1.821-1.791 3.456-1.906 5.248-.115 1.791 1.313 3.675 1.215 5.449s-1.728 3.531-1.808 5.282c-.087 1.843 1.37 3.709 1.296 5.426-.075 1.9-1.682 3.64-1.728 5.299-.075 2.022 1.405 3.882 1.359 5.414-.098 3.335-1.624 2.644-1.676 5.322z"
                    fill="#fff"
                />
                <path
                    d="M242.462 158.648v57.899m2.528-51.834-2.638 2.281-2.16-2.88m4.798 10.679-2.638 2.281-2.16-2.88m4.798 10.08-2.638 2.281-2.16-2.88m4.798 11.877-2.638 2.281-2.16-2.88m4.798 11.998-2.638 2.281-2.16-2.88"
                    stroke="#1E1E1E"
                    stroke-width=".607"
                    stroke-miterlimit="10"
                />
                <path
                    d="M224.455 217.296h12.517c-.242-1.532-1.227-1.261-1.354-3.634-.069-1.193 1.037-2.673.939-4.24-.075-1.296-1.348-2.621-1.451-4.095-.087-1.336 1.002-2.817.892-4.257s-1.388-2.661-1.503-4.078.95-2.88.829-4.268c-.12-1.388-1.44-2.673-1.584-4.032s.888-2.932.732-4.286-1.521-2.672-1.728-3.991c-.202-1.475.755-3.047.53-4.32-.277-1.555-1.728-2.684-2.028-3.831-.576-2.142-.501-4.204-1.152-4.337-.65-.132-.846 1.861-1.422 4.124-.271 1.152-1.688 2.304-1.924 3.842-.19 1.262.812 2.794.651 4.263-.15 1.313-1.469 2.574-1.596 4.032-.121 1.342.951 2.822.847 4.222-.104 1.399-1.382 2.667-1.475 4.032-.092 1.365 1.02 2.834.945 4.204-.075 1.371-1.336 2.725-1.4 4.073s1.054 2.88 1.003 4.193c-.064 1.463-1.302 2.811-1.348 4.09-.058 1.555 1.088 2.995 1.054 4.181-.081 2.569-1.256 2.039-1.296 4.107z"
                    fill="#1376A1"
                />
                <path
                    opacity=".2"
                    d="M224.455 217.296h12.517c-.242-1.532-1.227-1.261-1.354-3.634-.069-1.193 1.037-2.673.939-4.24-.075-1.296-1.348-2.621-1.451-4.095-.087-1.336 1.002-2.817.892-4.257s-1.388-2.661-1.503-4.078.95-2.88.829-4.268c-.12-1.388-1.44-2.673-1.584-4.032s.888-2.932.732-4.286-1.521-2.672-1.728-3.991c-.202-1.475.755-3.047.53-4.32-.277-1.555-1.728-2.684-2.028-3.831-.576-2.142-.501-4.204-1.152-4.337-.65-.132-.846 1.861-1.422 4.124-.271 1.152-1.688 2.304-1.924 3.842-.19 1.262.812 2.794.651 4.263-.15 1.313-1.469 2.574-1.596 4.032-.121 1.342.951 2.822.847 4.222-.104 1.399-1.382 2.667-1.475 4.032-.092 1.365 1.02 2.834.945 4.204-.075 1.371-1.336 2.725-1.4 4.073s1.054 2.88 1.003 4.193c-.064 1.463-1.302 2.811-1.348 4.09-.058 1.555 1.088 2.995 1.054 4.181-.081 2.569-1.256 2.039-1.296 4.107z"
                    fill="#fff"
                />
                <path
                    d="M229.83 172.022v44.698m1.953-40.009-2.039 1.757-1.665-2.223m3.704 8.242-2.039 1.763-1.665-2.224m3.704 7.782-2.039 1.757-1.665-2.223m3.704 9.17-2.039 1.756-1.665-2.217m3.704 9.256-2.039 1.763-1.665-2.224"
                    stroke="#1E1E1E"
                    stroke-width=".607"
                    stroke-miterlimit="10"
                />
                <path
                    d="M141.788 243.026c66.585 0 120.563-5.841 120.563-13.046 0-7.206-53.978-13.047-120.563-13.047S21.226 222.774 21.226 229.98c0 7.205 53.977 13.046 120.562 13.046"
                    fill="#1376A1"
                />
                <path
                    opacity=".5"
                    d="M141.788 243.026c66.585 0 120.563-5.841 120.563-13.046 0-7.206-53.978-13.047-120.563-13.047S21.226 222.774 21.226 229.98c0 7.205 53.977 13.046 120.562 13.046"
                    fill="#fff"
                />
                <path
                    d="m73.118 154.385 4.913 34.105-15.028 33.909 4.24 1.06 21.484-35.643 1.924-20.621 20.425 15.126 8.191 35.839 4.913-.478L119.457 175l-21.963-23.604-1.544-3.566z"
                    fill="#041820"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m116.732 94.044-1.67-4.078 4.464-4.631.91.328 2.044.864 1.342 1.405-4.129 6.987z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M114.975 89.718s.087-.824.167-2.149-.576-2.483.167-2.563a1.45 1.45 0 0 1 1.486 1.405c.087.824.167 2.304.167 2.304a4.2 4.2 0 0 1 1.245 1.982c.328 1.244-1.492 2.816-1.492 2.816zm-11.94 24.267 2.512.218 11.272-20.079 2.955.876-10.835 26.565-5.328-1.245z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M70.457 110.995s-9.09 9.308-9.09 10.731c0 1.422 11.18 32.256 11.687 33.079s23.04-6.117 23.04-6.37a4.4 4.4 0 0 0-.414-2.592c-.674-1.596-6.452-25.045-6.452-25.045l15.282 2.166-.743-9.124s-18.139-3.513-21.992-4.032c-3.854-.518-9.06-.737-11.318 1.187"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m87.345 115.039 1.872 5.76.34-5.092"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M71.125 108.403s-2.679 1.002-2.765 3.18 3.853 10.805 3.853 10.805 4.355-4.942 5.11-5.443 7.62.668 7.62.668-3.456-6.278-7.287-8.375c-3.83-2.096-6.531-.835-6.531-.835"
                    fill="#1376A1"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M69.281 106.059a33.5 33.5 0 0 0 3.295 6.445c2.264 3.519 7.373 9.792 7.453 7.874s-3.012-8.796-3.456-11.307-.576-3.185-.576-3.185-5.374 1.25-6.716.173m-5.408 12.291s2.983-2.983 6.647 3.664c3.663 6.647 14.728 31.887 14.728 31.887l-2.701.098S70.41 126.927 69.16 124.323s-3.18-6.336-6.554-4.429zm-3.376 6.17-4.044 28.903 2.408.092 3.37-28.995z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M62.082 97.096s-.254 1.67.167 2.344c.42.674 3.513 3.768 3.934 3.013.42-.755.921-4.942.086-6.111-.835-1.17-3.018-1.089-4.187.754"
                    fill="#041820"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M78.497 93.657s1.924 6.618 1.924 8.064-1.509 5.109-2.932 5.864c-1.422.754-2.01.576-3.099.507-1.088-.069-4.855-.507-6.278-1.676a7.3 7.3 0 0 1-1.843-2.011 5.4 5.4 0 0 1-3.606-1.428c-1.59-1.503-1.843-3.514-.835-4.032s3.266 1.342 3.266 1.342l-.334-2.258 12.06-5.449a2.07 2.07 0 0 1 1.676 1.077"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M75.565 97.344s.502 1.342 1.003 1.59c.5.247 1.595.506 1.008 1.152a4.8 4.8 0 0 1-1.256 1.008m-.42 2.615s-2.178 1.255-3.52-.668"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M216.248 94.24s-4.43.518-5.34-5.34 13.248-7.287 18.357-7.028 8.848 4.424 9.113 10.282-2.996 11.198-3.387 14.319c-.392 3.122 3.254 1.152 3.254 1.152s.133 3.773-4.948 5.726c-5.08 1.953-10.022.91-11.065-1.953s1.152-7.159 1.953-8.594-1.82-3.64-2.212-6.243a8.1 8.1 0 0 1 .392-4.298s-4.556 2.103-6.117 1.976"
                    fill="#041820"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M225.366 90.322s-1.728 2.143 2.753 4.89c4.481 2.748 7.033 2.754 7.949 4.487m1.279-2.931c.109.599.125 1.21.046 1.814m-8.969-10.299s.103 1.429 4.182 3.162c2.569 1.09 3.922 2.754 4.498 4.395m-5.471 16.33c.432.405.993.643 1.584.674m-3.059-13.449a5.1 5.1 0 0 1 .916 6.111 6.37 6.37 0 0 0-.346 5.38m-17.182-23.058c-1.008-.19-1.699-.127-1.936.576m18.548-3.156s-2.345 3.162-7.748 3.876c-2.839.375-5.489-.408-7.459-.938m-2.931 3.564s1.63-1.63 3.26-.103"
                    stroke="#fff"
                    stroke-width=".75"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M217.37 109.164s-10.8 2.592-11.301 3.237-10.806 17.355-10.806 17.355l-26.346-2.46-.219 3.669 30.24 5.04 5.835-5.541 2.16 5.541s-6.336 12.027-7.92 19.659-3.312 25.776-3.387 32.325.288 13.392 1.872 19.008 5.76 16.059 5.76 16.059-6.261 3.381-8.928 4.608-1.584 1.653-.72 1.872 6.192-.144 9.579-.576 6.192.288 6.192-1.008-1.659-6.411-2.016-7.995-2.88-14.901-2.88-21.744 2.736-17.925 2.736-17.925l3.237-12.096s-1.077 18.576-.357 23.76 10.581 32.181 10.581 32.181-4.464 4.464-6.048 6.768-1.152 3.018-.288 2.811c6.912-1.728 9.124-4.752 10.276-5.547s0-2.949-.576-4.389-2.448-19.803-3.099-24.555-1.728-9.285-1.728-9.285 8.496-23.904 7.92-33.408-4.389-21.819-4.389-21.819 8.421-14.832 8.277-16.197-8.421-8.715-8.421-8.715z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M211.852 156.672c-6.088-1.912-9.826-3.272-12.009-4.13a33 33 0 0 0-.83 3.145c-1.584 7.632-3.312 25.776-3.387 32.325s.288 13.392 1.872 19.008c.513 1.814 1.291 4.124 2.114 6.422a9.2 9.2 0 0 0 6.48-.443c-.777-4.752-1.607-10.829-1.607-14.763 0-6.837 2.736-17.925 2.736-17.925l3.237-12.096s-1.077 18.576-.357 23.76c.392 2.845 3.543 12.257 6.302 20.16a16.6 16.6 0 0 0 5.932-1.469c-.535-4.712-1.054-9.36-1.336-11.433-.645-4.752-1.728-9.286-1.728-9.286s7.667-21.571 7.943-31.881a36.6 36.6 0 0 1-15.362-1.394m-8.663 72.299c3.381-.432 6.192.288 6.192-1.008a14 14 0 0 0-.535-2.638l-4.366.743s-.196-.962-.288-1.923a1.16 1.16 0 0 0-.916-1.078s-6.261 3.382-8.928 4.608c-2.667 1.227-1.584 1.654-.72 1.872s6.174-.144 9.561-.576m18.07-4.153a1.65 1.65 0 0 0-.968-.276c-1.117 1.152-4.354 4.481-5.656 6.37-1.584 2.304-1.152 3.019-.288 2.811 6.912-1.728 9.124-4.752 10.276-5.547.749-.518.53-1.618.121-2.724-.64.464-1.325.864-2.045 1.192-.363 0-.668-1.348-1.44-1.826"
                    fill="#041820"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m175.899 128.379-3.531-2.667-5.184-.288v1.152l2.304.576.288.72-5.616.576.144 2.16 5.616 2.304 5.76-.864z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m222.629 109.809-5.259-.645s-10.8 2.592-11.301 3.237-10.805 17.355-10.805 17.355l-19.371-1.377-.219 3.669 23.259 3.969 5.835-5.541 2.16 5.541s-6.336 12.027-7.92 19.659a42 42 0 0 0-.375 1.987 41.55 41.55 0 0 0 28.149 4.608c.313-1.888.438-3.802.375-5.714-.576-9.504-4.389-21.819-4.389-21.819s8.421-14.832 8.277-16.197-8.416-8.732-8.416-8.732"
                    fill="#1376A1"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M211.127 130.752s3.496 4.954 6.117 5.823"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M216.363 120.608c1.486-.708 7.379-6.071 9.395-7.931a190 190 0 0 0-3.128-2.88l-5.259-.645-2.206.541a45 45 0 0 0-1.25 6.728c-.576 5.195.651 5.051 2.448 4.187"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M217.083 106.284a22 22 0 0 1-.507 4.308c-.507 2.16-1.803 7.701-1.008 7.845s7.632-7.488 7.632-7.488l.72-6.261z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M206.933 117.228s.432 2.88.288 3.381-3.242 3.168-3.242 5.115c.09 1.608.357 3.201.794 4.752"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m186.936 87.297-84.318 1.53a2.26 2.26 0 0 0-2.217 2.299l1.034 56.962a2.26 2.26 0 0 0 2.299 2.217l84.318-1.531a2.26 2.26 0 0 0 2.217-2.298l-1.034-56.963a2.26 2.26 0 0 0-2.299-2.217"
                    fill="#1376A1"
                    stroke="#041820"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m100.396 91.135 43.368 32.469a3.655 3.655 0 0 0 4.556-.133l40.757-34.468"
                    fill="#1376A1"
                />
                <path
                    d="m100.396 91.135 43.368 32.469a3.655 3.655 0 0 0 4.556-.133l40.757-34.468"
                    stroke="#041820"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m62.248 98.934 16.088-7.2s-2.517-5.444-3.773-6.866c-1.255-1.423-6.198-1.93-9.296-.674-3.1 1.255-5.76 4.608-5.945 6.284-.184 1.676 2.926 8.456 2.926 8.456m24.457-8.79s.081 1.503-2.177 2.678-6.365 1.256-5.363-.167c1.003-1.422 7.12-2.85 7.54-2.511"
                    fill="#041820"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M64.76 98.018a10.37 10.37 0 0 0 8.968-.098c4.775-2.344 6.785-5.362 9.464-6.451 2.678-1.089 4.688-1.423 3.099-1.728-1.59-.305-7.955 1.993-7.955 1.993z"
                    fill="#1376A1"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M70.271 91.953a1.037 1.037 0 0 1-1.353-.576l-.576-1.492a1.054 1.054 0 0 1 .576-1.354l2.914-1.152a1.04 1.04 0 0 1 .801 0 1 1 0 0 1 .576.576l.576 1.486a1.04 1.04 0 0 1 0 .801 1.05 1.05 0 0 1-.576.576l-2.915 1.152zm1.682-4.372-2.914 1.152a.81.81 0 0 0-.455 1.048l.576 1.486a.79.79 0 0 0 1.048.45l2.915-1.153a.807.807 0 0 0 .455-1.048l-.576-1.486a.8.8 0 0 0-.427-.443.8.8 0 0 0-.61-.006z"
                    fill="#fff"
                />
                <path
                    d="M71.2 89.884a.25.25 0 0 1-.173 0l-2.483-.714a.104.104 0 0 1-.069-.12.1.1 0 0 1 .087-.075.1.1 0 0 1 .04.005l2.465.72a.075.075 0 0 0 .087-.035l1.238-2.211a.1.1 0 0 1 .132-.035.1.1 0 0 1 .05.057.1.1 0 0 1-.01.076l-1.238 2.211a.26.26 0 0 1-.126.121"
                    fill="#fff"
                />
                <path
                    d="M120.188 88.975a.74.74 0 0 1-.743-.744v-2.568a.745.745 0 0 1 1.269-.526c.139.14.217.328.217.525v2.57a.744.744 0 0 1-.743.743m4.861-.271a.743.743 0 0 1-.899-.547l-.489-2.016a.75.75 0 0 1 .087-.563.745.745 0 0 1 1.359.211l.489 2.016a.75.75 0 0 1-.087.563.75.75 0 0 1-.46.336"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M123.839 88.704a.75.75 0 0 1-.904-.547l-.576-2.494a.746.746 0 0 1 1.452-.352l.604 2.494a.75.75 0 0 1-.304.782.8.8 0 0 1-.272.117"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M122.112 88.773a.75.75 0 0 1-.852-.616l-.404-2.535a.746.746 0 0 1 .617-.852.747.747 0 0 1 .852.616l.409 2.535a.73.73 0 0 1-.133.555.74.74 0 0 1-.489.297"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m225.113 120.545-3.929 15.759-25.488 6.699.069 2.805 29.163-4.32s7.125-20.085 7.269-21.813-3.744-4.251-3.744-4.251"
                    fill="#1376A1"
                />
                <path
                    d="m225.113 120.545-3.929 15.759-25.488 6.699.069 2.805 29.163-4.32s7.125-20.085 7.269-21.813-3.744-4.251-3.744-4.251"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M195.702 143.003s-4.464-2.304-5.115-2.523-4.464 1.44-5.616 1.515-2.16-.075-1.653.645a2.04 2.04 0 0 0 1.872.864c.72 0 3.6-.357 4.032-.357s-1.296 1.296-2.523 2.373-3.813 2.88-3.813 3.243.72.576 1.365.501 1.515-.213 2.016-.213 2.955.288 3.888-.219 4.395-2.736 4.395-2.736l1.221-.288zm20.153-51.108s-2.88 8.064-2.211 10.547c.668 2.482 3.121 5.27 5.333 5.397 2.212.126 6.509-1.365 7.033-2.535a72 72 0 0 0 1.043-2.476s2.212 0 2.603-1.152c.392-1.152.386-2.212-.651-2.88a3.26 3.26 0 0 0-2.217-.392s-2.471-1.152-2.604-3.773c-.075-1.573.056-3.15.392-4.689a21.6 21.6 0 0 1-4.032 1.82 11.1 11.1 0 0 1-4.689.133"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M217.21 95.616c-.202.633-.576 1.082-.835 1.002-.26-.08-.306-.662-.104-1.302s.576-1.088.835-1.002.305.645.104 1.302m4.176 1.204c-.202.633-.576 1.088-.836 1.002-.259-.087-.305-.663-.103-1.302.201-.64.576-1.083.835-1.002s.305.674.104 1.302"
                    fill="#041820"
                />
                <path
                    d="M218.131 95.42s-.098 1.832-1.221 2.546l-.507.322a.93.93 0 0 0-.424.72.93.93 0 0 0 .332.767c.31.28.694.466 1.106.535m-.916 2.218s2.65 1.324 4.28-.409m-4.384-8.841s1.02-1.124 1.942-.104m1.934.714s1.631-1.118 2.137.818"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m67.242 223.488 11.094 8.836s-.092.576-1.44.576-14.74-3.37-15.42-3.37-.864-.484-.864-.962 2.408-6.169 2.408-6.169z"
                    fill="#1376A1"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M60.595 228.568c0 .478.19.962.864.962s14.066 3.369 15.42 3.369 1.44-.576 1.44-.576l-17.373-4.855q-.229.533-.351 1.1"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M119.266 218.16s-.098 6.261 0 6.843.386.674.864.674 15.224-.386 15.512-.87a.58.58 0 0 0-.19-.766l-10.697-5.495-.576-.864z"
                    fill="#1376A1"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M119.266 225.003c.098.576.386.674.864.674s15.224-.386 15.512-.87a.577.577 0 0 0-.19-.766l-.576-.288-15.645.311c0 .467 0 .818.035.939M55.97 153.129l26.398-.576 1.158 23.507h-29.48z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m82.368 152.553 2.604.19S88.532 175 88.243 175c-.288 0-4.717 1.06-4.717 1.06z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m55.97 153.129 12.136 13.634 13.847-14.14"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="m79.833 139.559 2.88 2.344 24.999 5.864a15 15 0 0 0 1.843-1.676c.167-.334 3.934.086 4.354.086.421 0 1.152-.253 1.152.167s0 .922-.414 1.152c-.415.231-2.178.167-2.431.248s-1.59.501-1.59.501l7.454 2.765a4 4 0 0 1-1.152.922c-.576.253-2.932.086-2.932.086a27 27 0 0 1-3.6 1.002c-.922.087-4.188-1.336-4.188-1.336s-20.603-1.763-23.04-2.35-8.524-4.758-8.524-4.758z"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M64.339 119.958c-2.258-.334-5.11 2.765-4.268 7.373.84 4.608 11.22 21.444 11.22 21.444l10.051-8.715s-14.74-19.762-17.003-20.102"
                    fill="#fff"
                    stroke="#041820"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M208.253 61.09c-2.131-1.151-3.099-.195-3.876-1.151-.778-.956 2.131-3.49-3.681-6.008 0 0-.386-5.426-8.335-5.622s-5.812 5.426-7.949 6.785c-2.137 1.36-2.713-.777-4.844.576-2.131 1.354-1.152 4.067-2.909 4.459s-4.066-1.728-6.197-.392-2.132 2.523-3.105 2.523-2.88-.778-4.067 0a96 96 0 0 0-2.522 1.728h49.034s.582-1.734-1.549-2.897"
                    fill="#1376A1"
                />
                <path
                    opacity=".5"
                    d="M208.253 61.09c-2.131-1.151-3.099-.195-3.876-1.151-.778-.956 2.131-3.49-3.681-6.008 0 0-.386-5.426-8.335-5.622s-5.812 5.426-7.949 6.785c-2.137 1.36-2.713-.777-4.844.576-2.131 1.354-1.152 4.067-2.909 4.459s-4.066-1.728-6.197-.392-2.132 2.523-3.105 2.523-2.88-.778-4.067 0a96 96 0 0 0-2.522 1.728h49.034s.582-1.734-1.549-2.897"
                    fill="#fff"
                />
                <path
                    d="M114.048 71.107c-1.267-.69-1.843-.115-2.304-.69-.461-.577 1.261-2.069-2.189-3.566 0 0-.224-3.214-4.936-3.33-4.712-.115-3.456 3.22-4.718 4.032-1.261.813-1.607-.46-2.88.346s-.69 2.413-1.728 2.644c-1.036.23-2.413-1.037-3.674-.23s-1.268 1.491-1.838 1.491-1.728-.455-2.413 0a61 61 0 0 0-1.498 1.037h29.077s.362-1.048-.899-1.734"
                    fill="#fff"
                />
            </svg>
            <div style="flex-direction: column; justify-content: flex-start; align-items: center; gap: 4px; display: flex">
                <div style="text-align: center; color: #121926; font-size: 24px; font-weight: 500; line-height: 44.80px; word-wrap: break-word">
                    Nothing from artisans yet
                </div>
                <div style="text-align: center; color: #364152; font-size: 14px; font-weight: 400; line-height: 28.80px; word-wrap: break-word">
                    When artisans apply, message you, or update progress, weâ€™ll
                    keep you posted here.
                </div>
            </div>
        </div>
    );
};

export function NotificationsPage() {
    const [filter, setFilter] = createSignal<string>('all');
    const [selectedNotification, setSelectedNotification] =
        createSignal<NotificationModel | null>(null);
    const {
        userType: { authUser, setAuthUser },
        notification: { notificationList, setNotificationList },
    } = useAppContext();
    const notificationApi = new NotificationApiHandler();
    const filteredNotifications = () => {
        let currentNotifications = [...notificationList()];
        const currentFilter = filter();
        if (currentFilter === 'unread') {
            currentNotifications = currentNotifications.filter(
                (n) => !n.isRead
            );
        } else if (currentFilter !== 'all') {
            currentNotifications = currentNotifications.filter(
                (n) => n.type === currentFilter
            );
        }
        return currentNotifications.sort(
            (a, b) => b.timestamp.getTime() - a.timestamp.getTime()
        );
    };

    onMount(async () => {
        if (!authUser()) {
            const user = SecureLocalStorage.getItem<UserModel>(
                LocalStorageKey.AppAuthUserModel
            );
            if (!user) return;
            setAuthUser(user);
        }

        const result = await notificationApi.getUserNotifications(
            authUser()!.id
        );
        if (result.success) {
            setNotificationList([...notificationList(), ...result.data]);
        }
    });

    const handleToggleReadStatus = async (notificationID: string) => {
        const notification = notificationList().find(
            (c) => c.id === notificationID
        )!;
        if (!notification) return;

        let result = await notificationApi.toggleReadStatus(
            notification.id,
            !notification.isRead
        );

        if (result.success) {
            setNotificationList((prevNotifs) =>
                prevNotifs.map((notification) =>
                    notification.id === notificationID
                        ? { ...notification, isRead: !notification.isRead }
                        : notification
                )
            );
        }
    };

    const handleMarkAll = async (status: boolean) => {
        let result = await notificationApi.toggleAllReadStatus(
            authUser()!.id,
            status
        );
        if (result.success) {
            setNotificationList((prev) =>
                prev.map((notif) => ({ ...notif, isRead: status }))
            );
        }
    };

    const handleNotificationClick = (notif: NotificationModel) => {
        setSelectedNotification(notif);
        if (!notif.isRead) {
            handleToggleReadStatus(notif.id);
        }
    };

    const handleCloseNotificationCard = () => {
        setSelectedNotification(null);
    };

    return (
        <div class="min-h-screen bg-white text-gray-900 font-geist">
            <div class="min-h-screen mx-auto bg-white p-8 rounded-lg shadow-lg">
                <div class="mb-6 flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0 sm:space-x-4">
                    <div class="flex space-x-2">
                        <button
                            onClick={() => handleMarkAll(true)}
                            class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-400"
                        >
                            Mark All as Read
                        </button>
                        <button
                            onClick={() => handleMarkAll(false)}
                            class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400"
                        >
                            Mark All as Unread
                        </button>
                    </div>
                    <select
                        value={filter()}
                        onInput={(e) => setFilter(e.currentTarget.value)}
                        class="p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"
                    >
                        <option value="all">All Notifications</option>
                        <option value="unread">Unread</option>
                        <option value="job">Job Updates</option>
                        <option value="message">Messages</option>
                        <option value="review">Reviews</option>
                        <option value="payment">Payments</option>
                        <option value="system">System Alerts</option>
                        <option value="contact">Contact Alerts</option>
                        <option value="appointment">Appointment Alerts</option>
                        <option value="email">Email Alerts</option>
                        <option value="goal">Goal Alerts</option>
                        <option value="general">General Alerts</option>
                    </select>
                </div>

                <div class="notifications-container space-y-4">
                    <Show
                        when={filteredNotifications().length > 0}
                        fallback={
                            // <p class="text-center text-gray-500 py-10">
                            //     No notifications found.
                            // </p>
                            <EmptyNotifications />
                        }
                    >
                        <For each={filteredNotifications()}>
                            {(notif) => (
                                <div
                                    tabindex="0"
                                    role="button"
                                    onClick={() =>
                                        handleNotificationClick(notif)
                                    }
                                    class={`notification-item p-4 rounded-lg shadow-sm flex items-start space-x-4
                          ${notif.isRead ? 'read' : 'unread'}`}
                                    style="margin-right: 6px"
                                >
                                    <div
                                        class="flex-shrink-0 pt-1"
                                        innerHTML={getNotificationIcon(
                                            notif.type
                                        )}
                                    />
                                    <div class="flex-grow">
                                        <h3 class="text-lg font-semibold text-gray-900">
                                            {notif.title}
                                        </h3>
                                        <p class="text-gray-700 text-sm mb-1">
                                            {notif.message}
                                        </p>
                                        <span class="text-xs text-gray-500">
                                            {formatRelativeTime(
                                                notif.timestamp
                                            )}
                                        </span>
                                    </div>
                                    {/* MODIFIED: Button container with responsive stacking */}
                                    <div class="flex-shrink-0 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                                        <button
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                handleToggleReadStatus(
                                                    notif.id
                                                );
                                            }}
                                            class={`px-3 py-1 rounded-md text-sm
                              ${
                                  notif.isRead
                                      ? 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                      : 'bg-blue-100 text-blue-700 hover:bg-blue-200'
                              }`}
                                        >
                                            {notif.isRead
                                                ? 'Mark as Unread'
                                                : 'Mark as Read'}
                                        </button>
                                        <Show when={notif.link}>
                                            <a
                                                href={notif.link}
                                                onClick={(e) =>
                                                    e.stopPropagation()
                                                }
                                                class="px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 text-sm text-center sm:w-auto"
                                            >
                                                View
                                            </a>
                                        </Show>
                                    </div>
                                </div>
                            )}
                        </For>
                    </Show>
                </div>

                {filteredNotifications().length > 0 && (
                    <p class="text-gray-500 text-sm mt-8 text-center">
                        Note: Clicking notifications can mark it as read/unread
                    </p>
                )}
            </div>

            <Show when={selectedNotification()}>
                <NotificationDetailCard
                    notification={selectedNotification()!}
                    onClose={handleCloseNotificationCard}
                />
            </Show>

            <style>{`
                .notifications-container {
                max-height: calc(100vh - 200px);
                overflow-y: auto;
                scrollbar-width: thin;
                scrollbar-color: #a0aec0 #edf2f7;
                }
                .notifications-container::-webkit-scrollbar {
                width: 8px;
                }
                .notifications-container::-webkit-scrollbar-track {
                background: #edf2f7;
                border-radius: 10px;
                }
                .notifications-container::-webkit-scrollbar-thumb {
                background-color: #a0aec0;
                border-radius: 10px;
                border: 2px solid #edf2f7;
                }

                .notification-item {
                cursor: pointer;
                transition: background-color 0.2s ease;
                }

                .notification-item.unread {
                background-color: #eff6ff;
                border-left: 4px solid #3b82f6;
                }
                .notification-item.read {
                background-color: #ffffff;
                border-left: 4px solid transparent;
                }
                .notification-item:hover {
                background-color: #e2e8f0;
                }
            `}</style>
        </div>
    );
}

function getNotificationTypeTitle(type: NotificationType): string {
    switch (type) {
        case 'message':
            return 'New Message';
        case 'job':
            return 'Job Update';
        case 'review':
            return 'New Review';
        case 'payment':
            return 'Payment Received';
        case 'system':
            return 'System Alert';
        case 'general':
            return 'General NotificationModel';
        default:
            return 'NotificationModel';
    }
}

interface NotificationDetailCardProps {
    notification: NotificationModel;
    onClose: () => void; // Callback to close the card
}

export function NotificationDetailCard(props: NotificationDetailCardProps) {
    const { notification, onClose } = props;

    return (
        <div class="fixed inset-0 bg-gray-600 bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-50 transition-opacity duration-300">
            <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full mx-auto p-8 relative transform scale-100 transition-transform duration-300">
                {/* Close Button */}
                <button
                    onClick={onClose}
                    class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-300 rounded-full p-1"
                    aria-label="Close notification details"
                >
                    <svg
                        class="w-6 h-6"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M6 18L18 6M6 6l12 12"
                        ></path>
                    </svg>
                </button>

                {/* Header Section */}
                <div class="flex items-center space-x-4 mb-4">
                    {/* The icon can be dynamically rendered here if needed */}
                    {/* <div innerHTML={getNotificationIcon(notification.type)} class="text-4xl"></div> */}
                    <h2 class="text-2xl sm:text-3xl font-extrabold text-gray-900 leading-tight">
                        {notification.title}
                    </h2>
                </div>

                {/* Metadata Section */}
                <div class="mb-6 space-y-1 text-sm text-gray-600 border-b border-gray-200 pb-4">
                    <div class="flex items-center">
                        <span class="font-semibold text-gray-800 w-24">
                            Type:
                        </span>
                        <span class="capitalize">
                            {getNotificationTypeTitle(notification.type)}
                        </span>
                    </div>
                    <div class="flex items-center">
                        <span class="font-semibold text-gray-800 w-24">
                            Received:
                        </span>
                        <span>{notification.timestamp.toLocaleString()}</span>
                    </div>
                    <div class="flex items-center">
                        <span class="font-semibold text-gray-800 w-24">
                            Status:
                        </span>
                        <span
                            class={
                                notification.isRead
                                    ? 'text-green-600'
                                    : 'text-yellow-600 font-bold'
                            }
                        >
                            {notification.isRead ? 'Read' : 'Unread'}
                        </span>
                    </div>
                </div>

                {/* Message Body */}
                <div class="prose max-w-none text-gray-800 mb-6">
                    <p class="leading-relaxed whitespace-pre-wrap">
                        {notification.message}
                    </p>
                </div>

                {/* Action Button */}
                {/* <Show when={notification.link}>
                    <a
                        href={notification.link}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200"
                        onClick={onClose}
                    >
                        View Details
                        <svg
                            class="ml-3 h-5 w-5"
                            fill="currentColor"
                            viewBox="0 0 20 20"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"></path>
                            <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"></path>
                        </svg>
                    </a>
                </Show> */}
            </div>
        </div>
    );
}
